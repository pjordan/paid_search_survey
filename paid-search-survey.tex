% v2-acmsmall-sample.tex, dated March 6 2012
% This is a sample file for ACM small trim journals
%
% Compilation using 'acmsmall.cls' - version 1.3 (March 2012), Aptara Inc.
% (c) 2010 Association for Computing Machinery (ACM)
%
% Questions/Suggestions/Feedback should be addressed to => "acmtexsupport@aptaracorp.com".
% Users can also go through the FAQs available on the journal's submission webpage.
%
% Steps to compile: latex, bibtex, latex latex
%
% For tracking purposes => this is v1.3 - March 2012

\documentclass[prodmode,acmtist]{acmsmall} % Aptara syntax

% Package to generate and customize Algorithm as per ACM style
\usepackage[ruled]{algorithm2e}
\renewcommand{\algorithmcfname}{ALGORITHM}
\SetAlFnt{\small}
\SetAlCapFnt{\small}
\SetAlCapNameFnt{\small}
\SetAlCapHSkip{0pt}
\IncMargin{-\parindent}

% Metadata Information
\acmVolume{9}
\acmNumber{4}
\acmArticle{39}
\acmYear{2013}
\acmMonth{3}

\newcommand{\subjectto}{\mathop{\rm {subject\ to}}\nolimits}

% Document starts
\begin{document}

% Page heads
\markboth{P.~R.~Jordan}{Modern Paid Search}

% Title portion
\title{Modern Paid Search}
\author{PATRICK R. JORDAN
\affil{Microsoft}}

\begin{abstract}
TODO: Abstract
\end{abstract}

\category{K.4.4}{Computers and Society}{Electronic Commerce}

\terms{Algorithms, Economics}

\keywords{Online advertising, paid search}

\acmformat{Patrick R. Jordan, 2013. Modern Paid Search.}

\maketitle

\section{Introduction}

TODO

\section{History} % (fold)
\label{sec:history}

The primary origins of paid search are well documented \cite{Jansen:2008uq}.
OpenText Corporation, an early provider of search technology for Yahoo! in the mid-1990s, developed, arguably, the first paid search system.\footnote{see \url{http://www.opentext.com/2/global/company/company-history-95-98.htm}}
In contrast to banner advertising, where advertisers purchased slots within web pages where their ads were shown, OpenText allowed advertisers to position ads within search results.
Advertisers could select which user queries would trigger premium placement of their ads.
However, rather than place paid links around organic (non-paid) links, as current systems do, OpenText maintained a single set of links whose order could be manipulated as to favor paying advertisers.\footnote{see \url{http://news.cnet.com/2100-1023-215491.html}}
This early experiment in manipulating search results failed due to customer and industry complaint, and the project was scrapped. 
Following OpenText's failed venture, Goto.com pioneered a new system in Februrary 1998, whereby paid links appeared alongside, rather than within, the organic search results.\footnote{see \url{http://news.cnet.com/Pay-for-placement-gets-another-shot/2100-1023_3-208309.html}}

In a further departure from the existing online advertising systems, advertisers using paid search to place ads did not pay each time a user viewed an ad (pay per impression), rather each time a user clicked their link (pay per click).
In GoTo's system, each time a user queries the search engine, paid ad placement was determined by an auction run in real-time.
Advertisers submitted bids signifying their willingness-to-pay per click and selected which queries they would bid on by specifying keywords that the query must match.
Advertisers were ranked according to their bid and premium slots were allocated in accordance with that ranking. 

Goto.com was renamed Overture in 2001.
In February 2002, Overture changes the pricing rules of the auction: each winning advertiser pays the maximum of the next highest bid or the reserve price, termed \emph{generalized second price} (GSP).
In March 2002, Google modifies its existing AdWords system to conform to GSP, however their new system incorporates quality signals, such as the rate users click the ad (CTR), in addition to bids when determining ranking. 
Overture immediately files a patent infringement lawsuit against Google.


Subsequently, circa 2005, a few other entrants including Ask.com, LookSmart, and MSN/Live.com launch their own paid search services.
In 2007, Yahoo! Search Marketing, after aquiring Overture in 2003, switched from \emph{bid ordering} to \emph{revenue-ordering} (the product of CTR and bid) when its Panama system launched. 
In 2010, Microsoft and Yahoo! announced their search partnership, which combined two separate paid search marketplaces into one powered by Microsoft's Bing for algorithmic search and AdCenter (now Bing Ads) for paid search. 
GSP remains the dominant pricing rule in the current paid search marketplaces.

% section history (end)

\section{Marketplace Environment} % (fold)
\label{sec:paid_search_marketplace}

In practice, paid search marketplaces have a number of strategic participants that include advertisers, publishers (search engines), agencies, and optimization platforms.  
Existing research into these markets typically abstracts the intermediate relationships and focuses principally on the interaction between endpoints: advertisers and publishers.  
Users, whose behavior is not considered strategic, play an important role in defining the value of the transactions in the market. 
Abstractly, advertisers derive value by inducing users to transact with them.  
Publishers provide an avenue for advertisers to influence users through ads on a search results page (SERP).  
In response, publishers charge for that influence.  
Publishers determine how ads are allocated to available slots on the SERP and how much advertisers are charged for being allocated. 

In all major search engines, advertisers pay when a user clicks on their respective ad.  
When a click occurs, the user is directed to the advertiser's landing page.  
Advertisers derive value from the subsequent interaction by the user---for instance, the user may purchase one of the advertiser's products.  
Because individual users can behave differently, advertisers may ascribe a value to click that depends on the features of a particular user. 

One of the most salient features of a particular user, in terms of estimating the value to an advertiser, is the query the user submitted to the search engine.  
In some cases, the query gives a strong signal of monetizable user intent.  
Because the value of a click may differ vastly according to a particular user and advertiser, publishers use auctions to determine allocation and pricing in paid search marketplaces. 

Abstractly, advertisers place bids in terms of their willingness to pay per click and publishers determine which ads get allocated to which slots and at what contingent price.  
Because the user query can be so discriminating in terms of advertiser value, advertisers condition their decision to bid on the keywords within the query.  
In this way, keywords define submarkets. 

Page layout of the SERP is determined as a result of the auction.
The presentation of an advertisement varies by publisher, however many of the basic components are consistent across publishers.
Basic ads typically consist of three lines of text: a line containing a text link (typically colored blue), a line containing a url (typically colored green), and a line text copy (typically colored black). 
Publishers may decorate the basic ads with extensions such as navigational links within the advertiser's site.  
Publishers have also introduced new ad types that center around products.  
These new formats allow for other media to be displayed, such as images. 
In general, the candidate locations for the ads are above, to the right, and below the organic results.  
Positions above the organic results, sometimes referred to as \emph{North} or \emph{Main Line} positions, often are priced at a premium since they generally receive the lion's share of clicks.

In order to participate in the marketplace, advertisers define campaigns that consist of ads to be displayed for different keywords as well as their willingness to pay per click for the displaying the ad.  
In addition advertisers may specific budgets, which the publishers' systems respect, as well as other signals of value, such as conversion data. 

% section paid_search_marketplace (end)

\section{An Economic Model} % (fold)
\label{sec:auction_and_marketplace_design}

The strategic interactions between publishers and advertisers in a paid search marketplace can be modeled as a game---see \citeN{Osborne:1994fu} for an introduction to game theory.
Game theory provides a rich mathematical framework from which we can hope to understand the inventives of each participant and predict their responses to changes in the marketplace.
From a modeler's perspective, this scenario can be classified as a stochastic game of severely incomplete and imperfect information.
Even with recent advances in computational and empirical game theory, we have little hope of compactly describing the scenario, let alone determining a solution (equilibrium).


In order to make traction in understanding the strategic choices of participants, early research heavily abstracted the scenario down to a single (or infinitely repeated) auction for a single keyword as described in Section~\ref{sub:single_auction_model}, whose equilibria are characterized in Section~\ref{sub:equilibrium_characterization}. 
These models help us understand many of the salient features of the marketplace, however the complexity of the scenario limits the fidelity of the model.
As marketplace designers, we will sometimes revert to decision and control-theoretic methods when insights from game theory are not available.


\subsection{Single Auction Model} % (fold)
\label{sub:single_auction_model}

Consider a single auction for a user query. 
There are a set of advertisers, $\mathcal{I} = \{1,\ldots,I\}$, and a set of available slots, $\mathcal{J} = \{1, \ldots, J\}$.  
The user's click behavior is defined probabilistically: a user clicks on advertiser $i$'s ad in position $j$ with probability $\kappa_{i,j}$.  
In these models, the click probability $\kappa$ is assumed to be separable, in that $\kappa_{i,j} = \alpha_j\gamma_i$ where $\alpha_j$ is the position effect for slot $j$ and $\gamma_i$ is the advertiser effect for advertiser $i$.  
Slots are ordered in terms of $\alpha$ with $\alpha_1 \ge \alpha_2 \ge \cdots \ge \alpha_{J}$.    
Finally, each advertiser $i$ submits a bid $b_j$ to the publisher that represents $i$'s willingness-to-pay for a click, which may differ from the advertiser's true value for the click, $v_i$. 
The auction will assign advertisers to slots and set contingent prices to be paid when an ad is clicked, in general referred to as \emph{allocation} and \emph{pricing} rules, respectively.


Before describing GSP, first consider another common auction format, the Vickrey-Clark-Groves (VCG) auction \cite{Vickrey:1961ys}.
This auction has two important properties in our context: advertisers are incentivized to bid truthfully (reveal their true value per click) and the outcome is efficient (the value that values the slot the most wins the slot).
Additionally, the auction is very simple to understand algorithmically.
Let $V_i^j = \kappa_{i,j} v_i$ be the welfare of assigning advertiser $i$ slot $j$.
Let $V_\mathcal{I}^\mathcal{J}$ be the maximum achievable welfare by assigning at most one advertiser to each slot, similarly $V_{\mathcal{I}\setminus \{i\}}^\mathcal{J}$ is the maximum achievable welfare without advertiser $i$.
If advertiser $i$ is allocated slot $j$, then $i$ pays an amount $p_i$ per click:
\begin{equation}
\kappa_{i,j} p_{i} = V_{\mathcal{I}\setminus \{i\}}^\mathcal{J} - V_{\mathcal{I}\setminus \{i\}}^{\mathcal{J}\setminus \{j\}}.
\label{eqn:vcg-price}
\end{equation}
The expected payment is the \emph{externality} advertiser $i$ imposes on the other participants (advertisers and publisher).
Notice that if we have an algorithm for solving $V_\mathcal{I}^\mathcal{J}$, then we can na\"{i}vely run the VCG auction with a linear number of calls to the algorithm.
Often, as is the case in paid search, there is more structure to the problem that we can exploit to run the auction more efficiently.
Consider Example~\ref{ex:simple-setting} for illustration.

\begin{example}
For a given a keyword auction, there are two available slots ($1$ and $2$) having $\alpha$s of 1.0, and 0.5, respectively.  
There are three advertisers ($a$, $b$, and $c$) competing for the slots with $\gamma$s of 0.8, 0.9, 1, respectively, each having a unit value per click.
\label{ex:simple-setting} 
\end{example}

The welfare maximizing allocation occurs when the $c$ is assigned the slot 1 and the $b$ is assigned slot 2, with $a$ not shown.  
This yields an expected welfare of $1.45$, of which $c$ contributes $0.90$ and $b$ contributes $0.45$.
The welfare maximizing allocation without $c$ is $1.30$, which occurs when $b$ is allocated slot 1 and $a$ is allocated slot 2.
The welfare maximizing allocation without $b$ is $1.40$, which occurs when $c$ is allocated slot 1 and $a$ is allocated slot 2.
The externality $c$ imposes is $1.30 - 0.45 = 0.85$, whereas the externality $b$ imposes is $1.40 - 1 = 0.40$.
To determine the price paid by the advertisers, we compute the price per click required to pay the externality in expectation, which is simply $p_i / \kappa_{i,j}$.
Assuming the advertisers bid truthfully, the outcome is shown in Table~\ref{tab:vcg-example}.

\begin{table}[htbp]%
\tbl{VCG Outcome for Example~\ref{ex:simple-setting}.\label{tab:vcg-example}}{%
\begin{tabular}{c|c|r|r|r}
Slot & Advertiser & Welfare & Externality & Price \\\hline
1 & $c$ & 1 & 0.85 & 0.85 \\\hline
2 & $b$ & 0.45 & 0.40 &0.89 \\\hline
N/A & $a$ & 0 & 0 & 0\\\hline
\end{tabular}}
\end{table}%

The mechanics of the GSP auction are as follows.  
Each advertiser's ad is scored according to $s_i = x_i b_i$.
The coefficient $x_i$ is a function of $\gamma_i$ ad other factors.
For the basic model, assume $x_i \equiv \gamma_i$.
Advertisers are ranked according to $s_i$, with $(j)$ denoting the advertiser at index $j$ in the ranking.  
Slots are allocated according to the rank with slot $j$ going to advertiser $(j)$.  
If the ad is clicked, advertiser $(j)$ is charged a price of 

\begin{equation}
p_{(j)} = \frac{s_{(j+1)}}{s_{(j)}} b_{(j)}.	
\label{eqn:gsp-price}
\end{equation}

We can contrast the outcome with VCG to the outcome with GSP for Example~\ref{ex:simple-setting}.
For comparison, we assume that the advertisers bid truthfully, which we will see in Section~\ref{sub:equilibrium_characterization} that they are not incented to do.
First, we rank the advertisers in decreasing order of score: $s_c=1.0$, $s_b= 0.9$, and $s_a = 0.8$.
Then we allocate the advertiser according to their rank: $c$ gets slot 1 and $b$ gets slot 2.
Notice that the allocation for VCG and GSP is the same.
The prices are given by $p_c = s_b/s_c v_c$ and $p_b = s_a/s_b v_b$.
For each winning advertiser, correspond to the minimum bids required to maintain the same ranking.
The outcome is shown in Table~\ref{tab:gsp-example}.

\begin{table}[htbp]%
\tbl{GSP Outcome for Example~\ref{ex:simple-setting}.\label{tab:gsp-example}}{%
\begin{tabular}{c|c|r|r|r}
Slot & Advertiser & Score & Next Score & Price \\\hline
1 & $c$ & 1.0 & 0.9 & 0.9 \\\hline
2 & $b$ & 0.9 & 0.8 & 0.89 \\\hline
N/A & $a$ & 0.8 & 0 & 0\\\hline
\end{tabular}}
\end{table}%

Notice that for a single slot, the GSP and VCG outcomes coincide.
However, for multiple slots they differ in pricing with GSP having weakly higher prices for the same scenario.
 
% subsection single_auction_model (end)

\subsection{GSP Equilibria} % (fold)
\label{sub:equilibrium_characterization}

The first economic models for GSP were independently developed by economists from Google \cite{Varian:2007kx}
and Yahoo! \cite{Edelman:2007vn}.
The authors characterize the set of ex post Nash equilibria under a complete-information setting\footnote{The sets $\mathcal{I}$, $\mathcal{J}$, $\{\alpha_j\}_{j\in \mathcal{J}}$, and $\{\gamma_i\}_{i \in \mathcal{I}}$ are known to all participants.} with risk-neutral advertisers.
In this setting, the equilbria giving the lowest revenue to the publisher are outcome equivalent to the Vickrey-Clark-Groves (VCG) auction \cite{Vickrey:1961ys}.

The equilibria described by \citeANP{Varian:2007kx} and \citeANP{Edelman:2007vn} (EOS) assume advertisers determine bids for each individual auction. 
In current paid search systems, advertisers set bids that are used in a sequence of auctions from which advertisers receive aggregate feedback. 
By weakening the assumptions in the EOS model, in particular when advertisers are uncertain about entry (the competing set of advertisers) as well as their own quality scores ($x_i$s) over a sequence of auctions where the bids are fixed, \citeN{Athey:2012zr} show that there can be a significant divergence in revenue from VCG and GSP.

In addition to the models proposed by \citeANP{Varian:2007kx}, \citeANP{Edelman:2007vn}, and \citeANP{Athey:2012zr}, there have been numerous academic studies on variants of GSP or other auction mechanisms---see \citeN{Jansen:2008uq} for a survey of these models.
While many of these studies provide novel theoretical insights, the chactarizations by the former provide the theoretical foundation for many of advanced techniques (see Section~\ref{sec:advanced_topics}) found in practice today.

% subsection equilibrium_characterization (end)

\subsection{Advertiser Response}

TODO

% subsection advertiser_response (end)

% section auction_and_marketplace_design (end)

\section{Machine Learning} % (fold)
\label{sec:machine_learning}

% section machine_learning (end)
\subsection{Query Understanding} % (fold)
\label{sub:query_understanding}

TODO

% subsection query_understanding (end)


\subsection{Ad Selection and Relevance Modeling} % (fold)
\label{sub:ad_selection_and_relevance_modeling}

TODO

% subsection ad_selection_and_relevance_modeling (end)

\subsection{User Response Modeling} % (fold)
\label{sub:user_response_modeling}

TODO

% subsection user_response_modeling (end)

\section{Optimization}
\label{sec:optimization}

\subsection{Revenue Optimization} % (fold)
\label{sub:revenue_optimization}

In his seminal work on optimal auction design, \citeN{Myerson:1981kb} proposed a Bayesian mechanism used to extract the optimal revenue from an auction.
His mechanism exploits the prior distribution of bidder signals (private values).
Extensions of his work have touched many different auction scenarios including paid search. 

For instance, \citeN{Edelman:2010ly} derive an optimal mechanism that uses a single reserve price.
Using the model from Section~\ref{sub:single_auction_model}, the author's assume the publisher has a prior distribution on weighted values $\pi_i = \gamma_i v_i$ and that each bidder's weighted value is drawn i.i.d. from a distribution $F(\cdot)$ with pdf $f(\cdot)$ that satisfy \citeANP{Myerson:1981kb}'s regularity conditions.
These conditions are satisfied, for instance, if the \emph{virtual valuation} $\psi(\pi) = \pi - \frac{1 - F(\pi)}{f(\pi)}$ is decreasing in $\pi$.
Methods for infering $F$ are described in Section~\ref{sub:revenue_optimization}.

\citeANP{Edelman:2010ly} propose a modification to GSP such that, in order to win a slot, each $s_i \ge r$ and the pricing equation (\ref{eqn:gsp-price}) is updated such that
\begin{equation}
p_{(j)} = \frac{\max\{s_{(j+1)},r\}}{s_{(j)}} b_{(j)}.
\label{eqn:gsp-reserve-price}	
\end{equation}
The reserve price, $r^\star$, that optimizes revenue satisfies $\psi(r^\star) = 0$.
In practice, we observe that bidders' scores are not drawn i.i.d. nor, presumably, are their weighted values.
Nevertheless, in a complementary study, \citeN{Ostrovsky:2009ve} investigate the effects of applying reserve prices to Yahoo!'s paid search marketplace.  
They show that the application of reserve prices significantly increased Yahoo!'s revenue.

In a similar vein, however using a qualitatively different approach, \citeN{Lahaie:2007ly} propose a mechanism that alters $x_i$, the quality coefficient in scoring.
Namely, $x_i \equiv \gamma_i^\omega$, which is commonly referred to as \emph{squashing}.
Observe that when $\omega = 0$, we have the original rank-by-bid mechanism and when $\omega = 1$ we have the standard GSP mechanism (rank-by-revenue).
The optimal value for $\omega$ depends on the correlation between $\gamma_i$ and $b_i$.

In practice, both reserve prices and squashing are used to optimize revenue or other objectives.
The values for these parameters are set via counterfactual simulation.
Often the counterfactual simulation assumes no advertiser response, as in \citeN{Acharya:2007pd}.
Estimating advertiser response at scale is an open problem.

% subsection revenue_optimization (end)

\subsection{Budget Optimization} % (fold)
\label{sub:budget_optimization}

TODO

% subsection budget_optimization (end)

\subsection{User Utility} % (fold)
\label{sub:user_utility}

TODO

% subsection user_utility (end)

\subsection{General Problem} % (fold)
\label{sub:general_problem}

As we depart from the basic GSP model of an auction, we introduce more auction parameters.
In order for publishers to meet their objectives, be they revenue, efficiency, or otherwise, they need to tune these parameters.
We now consider the general problem of determining optimal values for a set of auction parameters $(p_i)_{i=1}^K$.

In doing so, we use a model that only considers first-order effects (no advertiser response), principally, due to the lack of an accurate behavioral model.
Partially because of the lack of a second-order model, and more generally due to the risk of overfitting, we partition the query space into clusters, $\mathcal{C} = \{1, \ldots, C\}$ where $Q_c$ denotes the set of queries belonging to cluster $c\in \mathcal{C}$.
Parameters may be set independently for each cluster $c$, denoted $p_i^c$.

We consider the abstract objective function $f$, such that $f^q(p)$ denote the result of evaluating $f$ on query $q$ with parameter settings $p$.
In addition, we only consider objective functions such that $f$ is additive across queries, hence $f^Q(p) = \sum _{q \in Q} f^q(p)$. 
We consider functions $h$ and $g$ similarly.

\begin{equation}
\begin{array}{rl}
\max & \sum\limits_{c \in C} f^{Q_c}(p^q) \\
\subjectto & \sum\limits_{c \in C} g_i^{Q_c}(p^q) = \forall i = 1,\ldots,M \\
                  & \sum\limits_{c \in C} h_j^q(p^q) \le \forall j = 1,\ldots,N\\
\end{array}
\end{equation}

% subsection general_problem (end)

% section optimization (end)

\section{Advanced Topics} % (fold)
\label{sec:advanced_topics}

TODO

\subsection{Value Estimation} % (fold)
\label{sub:value_estimation}

TODO:
\begin{itemize}
	\item \citeN{Ostrovsky:2009ve}
	\item \citeN{Varian:2007kx}
	\item \citeN{Athey:2012zr}
\end{itemize}	

% subsection value_estimation (end)

% section advanced_topics (end)

\section{Conclusion} % (fold)
\label{sec:conclusion}

TODO

% section conclusion (end)

% Acknowledgments
\begin{acks}
The author would like to thank J.C. Mao, Omer Har, Anton Schwaighofer, ... for their useful conversations and comments.
\end{acks}

% Bibliography
\bibliographystyle{ACM-Reference-Format-Journals}
\bibliography{paid-search-survey}
                             % Sample .bib file with references that match those in
                             % the 'Specifications Document (V1.5)' as well containing
                             % 'legacy' bibs and bibs with 'alternate codings'.
                             % Gerry Murray - March 2012

% History dates
\received{June 2013}{N/A}{N/A}

\end{document}
% End of v2-acmsmall-sample.tex (March 2012) - Gerry Murray, ACM


